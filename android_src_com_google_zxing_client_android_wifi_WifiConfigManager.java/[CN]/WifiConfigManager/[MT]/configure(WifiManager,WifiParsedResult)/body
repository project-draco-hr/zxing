{
  Runnable configureRunnable=new Runnable(){
    @Override public void run(){
      if (!wifiManager.isWifiEnabled()) {
        Log.i(TAG,"Enabling wi-fi...");
        if (wifiManager.setWifiEnabled(true)) {
          Log.i(TAG,"Wi-fi enabled");
        }
 else {
          Log.w(TAG,"Wi-fi could not be enabled!");
          return;
        }
        int count=0;
        while (!wifiManager.isWifiEnabled()) {
          if (count >= 10) {
            Log.i(TAG,"Took too long to enable wi-fi, quitting");
            return;
          }
          Log.i(TAG,"Still waiting for wi-fi to enable...");
          try {
            Thread.sleep(1000L);
          }
 catch (          InterruptedException ie) {
          }
          count++;
        }
      }
      String networkTypeString=wifiResult.getNetworkEncryption();
      NetworkType networkType;
      try {
        networkType=NetworkType.forIntentValue(networkTypeString);
      }
 catch (      IllegalArgumentException iae) {
        Log.w(TAG,"Bad network type; see NetworkType values: " + networkTypeString);
        return;
      }
      if (networkType == NetworkType.NO_PASSWORD) {
        changeNetworkUnEncrypted(wifiManager,wifiResult);
      }
 else {
        String password=wifiResult.getPassword();
        if (password == null || password.length() == 0) {
          throw new IllegalArgumentException();
        }
        if (networkType == NetworkType.WEP) {
          changeNetworkWEP(wifiManager,wifiResult);
        }
 else         if (networkType == NetworkType.WPA) {
          changeNetworkWPA(wifiManager,wifiResult);
        }
      }
    }
  }
;
  new Thread(configureRunnable).start();
}
