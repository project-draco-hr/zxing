{
  this.activity=activity;
  multiFormatReader=new MultiFormatReader();
  this.resultPointCallback=resultPointCallback;
  if (decodeFormats == null || decodeFormats.isEmpty()) {
    SharedPreferences prefs=PreferenceManager.getDefaultSharedPreferences(activity);
    boolean decode1D=prefs.getBoolean(PreferencesActivity.KEY_DECODE_1D,true);
    boolean decodeQR=prefs.getBoolean(PreferencesActivity.KEY_DECODE_QR,true);
    if (decode1D && decodeQR) {
      doSetDecodeMode(CaptureActivity.ALL_FORMATS);
    }
 else     if (decode1D) {
      doSetDecodeMode(CaptureActivity.ONE_D_FORMATS);
    }
 else     if (decodeQR) {
      doSetDecodeMode(CaptureActivity.QR_CODE_FORMATS);
    }
  }
 else {
    doSetDecodeMode(decodeFormats);
  }
}
