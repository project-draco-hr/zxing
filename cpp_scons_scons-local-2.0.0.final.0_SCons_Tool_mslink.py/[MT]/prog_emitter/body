def prog_emitter(target, source, env):
    SCons.Tool.msvc.validate_vars(env)
    extratargets = []
    exe = env.FindIxes(target, 'PROGPREFIX', 'PROGSUFFIX')
    if (not exe):
        raise SCons.Errors.UserError(('An executable should have exactly one target with the suffix: %s' % env.subst('$PROGSUFFIX')))
    (version_num, suite) = SCons.Tool.msvs.msvs_parse_version(env.get('MSVS_VERSION', '6.0'))
    if ((version_num >= 8.0) and env.get('WINDOWS_INSERT_MANIFEST', 0)):
        extratargets.append(env.ReplaceIxes(exe, 'PROGPREFIX', 'PROGSUFFIX', 'WINDOWSPROGMANIFESTPREFIX', 'WINDOWSPROGMANIFESTSUFFIX'))
    if (('PDB' in env) and env['PDB']):
        pdb = env.arg2nodes('$PDB', target=target, source=source)[0]
        extratargets.append(pdb)
        target[0].attributes.pdb = pdb
    return ((target + extratargets), source)
