{
  final int ec_code=QRCode.GetECLevelCode(ec_level);
  if (ec_code == -1) {
    return false;
  }
  if (!QRCode.IsValidMaskPattern(mask_pattern)) {
    return false;
  }
  final int type_info=(ec_code << 3) | mask_pattern;
  bits.AppendBits(type_info,5);
  final int bch_code=MatrixUtil.CalculateBCHCode(type_info,kTypeInfoPoly);
  bits.AppendBits(bch_code,10);
  BitVector mask_bits=new BitVector();
  mask_bits.AppendBits(kTypeInfoMaskPattern,15);
  bits.XOR(mask_bits);
  if (bits.size() != 15) {
    Debug.LOG_ERROR("should not happen but we got: " + bits.size());
    return false;
  }
  return true;
}
