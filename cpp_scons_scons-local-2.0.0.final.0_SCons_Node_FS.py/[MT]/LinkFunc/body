def LinkFunc(target, source, env):
    src = source[0].abspath
    dest = target[0].abspath
    (dir, file) = os.path.split(dest)
    if (dir and (not target[0].fs.isdir(dir))):
        os.makedirs(dir)
    if (not Link_Funcs):
        set_duplicate('hard-soft-copy')
    fs = source[0].fs
    for func in Link_Funcs:
        try:
            func(fs, src, dest)
            break
        except (IOError, OSError):
            if (func == Link_Funcs[(-1)]):
                raise
    return 0
