{
  Camera theCamera=camera;
  if (theCamera == null) {
    theCamera=Camera.open();
    if (theCamera == null) {
      throw new IOException();
    }
    camera=theCamera;
  }
  theCamera.setPreviewDisplay(holder);
  if (!initialized) {
    initialized=true;
    configManager.initFromCameraParameters(theCamera);
    if (requestedFramingRectWidth > 0 && requestedFramingRectHeight > 0) {
      setManualFramingRect(requestedFramingRectWidth,requestedFramingRectHeight);
      requestedFramingRectWidth=0;
      requestedFramingRectHeight=0;
    }
  }
  configManager.setDesiredCameraParameters(theCamera);
  SharedPreferences prefs=PreferenceManager.getDefaultSharedPreferences(context);
  reverseImage=prefs.getBoolean(PreferencesActivity.KEY_REVERSE_IMAGE,false);
  if (prefs.getBoolean(PreferencesActivity.KEY_FRONT_LIGHT,false)) {
    FlashlightManager.enableFlashlight();
  }
}
