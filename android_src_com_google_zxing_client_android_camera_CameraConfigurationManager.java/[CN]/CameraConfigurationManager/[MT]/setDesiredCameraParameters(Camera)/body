{
  Camera.Parameters parameters=camera.getParameters();
  if (parameters == null) {
    Log.w(TAG,"Device error: no camera parameters are available. Proceeding without configuration.");
    return;
  }
  SharedPreferences prefs=PreferenceManager.getDefaultSharedPreferences(context);
  initializeTorch(parameters,prefs);
  String focusMode=findSettableValue(parameters.getSupportedFocusModes(),Camera.Parameters.FOCUS_MODE_AUTO,Camera.Parameters.FOCUS_MODE_MACRO);
  if (focusMode != null) {
    parameters.setFocusMode(focusMode);
  }
  parameters.setPreviewSize(cameraResolution.x,cameraResolution.y);
  camera.setParameters(parameters);
}
