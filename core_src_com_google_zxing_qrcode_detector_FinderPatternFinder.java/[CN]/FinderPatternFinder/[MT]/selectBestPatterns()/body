{
  int startSize=possibleCenters.size();
  if (startSize < 3) {
    throw NotFoundException.getNotFoundInstance();
  }
  if (startSize > 3) {
    float totalModuleSize=0.0f;
    float square=0.0f;
    for (int i=0; i < startSize; i++) {
      float size=((FinderPattern)possibleCenters.elementAt(i)).getEstimatedModuleSize();
      totalModuleSize+=size;
      square+=size * size;
    }
    float average=totalModuleSize / (float)startSize;
    float stdDev=(float)Math.sqrt(square / startSize - average * average);
    Collections.insertionSort(possibleCenters,new FurthestFromAverageComparator(average));
    float limit=Math.max(0.2f * average,stdDev);
    for (int i=0; i < possibleCenters.size() && possibleCenters.size() > 3; i++) {
      FinderPattern pattern=(FinderPattern)possibleCenters.elementAt(i);
      if (Math.abs(pattern.getEstimatedModuleSize() - average) > limit) {
        possibleCenters.removeElementAt(i);
        i--;
      }
    }
  }
  if (possibleCenters.size() > 3) {
    float totalModuleSize=0.0f;
    for (int i=0; i < possibleCenters.size(); i++) {
      totalModuleSize+=((FinderPattern)possibleCenters.elementAt(i)).getEstimatedModuleSize();
    }
    float average=totalModuleSize / (float)possibleCenters.size();
    Collections.insertionSort(possibleCenters,new CenterComparator(average));
    possibleCenters.setSize(3);
  }
  return new FinderPattern[]{(FinderPattern)possibleCenters.elementAt(0),(FinderPattern)possibleCenters.elementAt(1),(FinderPattern)possibleCenters.elementAt(2)};
}
