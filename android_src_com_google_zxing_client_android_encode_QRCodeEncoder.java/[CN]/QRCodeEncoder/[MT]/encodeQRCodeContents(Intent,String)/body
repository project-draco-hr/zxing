{
  if (type.equals(Contents.Type.TEXT)) {
    String data=intent.getStringExtra(Intents.Encode.DATA);
    if (data != null && data.length() > 0) {
      contents=data;
      displayContents=data;
      title=activity.getString(R.string.contents_text);
    }
  }
 else   if (type.equals(Contents.Type.EMAIL)) {
    String data=trim(intent.getStringExtra(Intents.Encode.DATA));
    if (data != null) {
      contents="mailto:" + data;
      displayContents=data;
      title=activity.getString(R.string.contents_email);
    }
  }
 else   if (type.equals(Contents.Type.PHONE)) {
    String data=trim(intent.getStringExtra(Intents.Encode.DATA));
    if (data != null) {
      contents="tel:" + data;
      displayContents=PhoneNumberUtils.formatNumber(data);
      title=activity.getString(R.string.contents_phone);
    }
  }
 else   if (type.equals(Contents.Type.SMS)) {
    String data=trim(intent.getStringExtra(Intents.Encode.DATA));
    if (data != null) {
      contents="sms:" + data;
      displayContents=PhoneNumberUtils.formatNumber(data);
      title=activity.getString(R.string.contents_sms);
    }
  }
 else   if (type.equals(Contents.Type.CONTACT)) {
    Bundle bundle=intent.getBundleExtra(Intents.Encode.DATA);
    if (bundle != null) {
      StringBuilder newContents=new StringBuilder(100);
      StringBuilder newDisplayContents=new StringBuilder(100);
      newContents.append("MECARD:");
      String name=trim(bundle.getString(ContactsContract.Intents.Insert.NAME));
      if (name != null) {
        newContents.append("N:").append(escapeMECARD(name)).append(';');
        newDisplayContents.append(name);
      }
      String address=trim(bundle.getString(ContactsContract.Intents.Insert.POSTAL));
      if (address != null) {
        newContents.append("ADR:").append(escapeMECARD(address)).append(';');
        newDisplayContents.append('\n').append(address);
      }
      Collection<String> uniquePhones=new HashSet<String>(Contents.PHONE_KEYS.length);
      for (int x=0; x < Contents.PHONE_KEYS.length; x++) {
        String phone=trim(bundle.getString(Contents.PHONE_KEYS[x]));
        if (phone != null) {
          uniquePhones.add(phone);
        }
      }
      for (      String phone : uniquePhones) {
        newContents.append("TEL:").append(escapeMECARD(phone)).append(';');
        newDisplayContents.append('\n').append(PhoneNumberUtils.formatNumber(phone));
      }
      Collection<String> uniqueEmails=new HashSet<String>(Contents.EMAIL_KEYS.length);
      for (int x=0; x < Contents.EMAIL_KEYS.length; x++) {
        String email=trim(bundle.getString(Contents.EMAIL_KEYS[x]));
        if (email != null) {
          uniqueEmails.add(email);
        }
      }
      for (      String email : uniqueEmails) {
        newContents.append("EMAIL:").append(escapeMECARD(email)).append(';');
        newDisplayContents.append('\n').append(email);
      }
      String url=trim(bundle.getString(Contents.URL_KEY));
      if (url != null) {
        newContents.append("URL:").append(url).append(';');
        newDisplayContents.append('\n').append(url);
      }
      String note=trim(bundle.getString(Contents.NOTE_KEY));
      if (note != null) {
        newContents.append("NOTE:").append(escapeMECARD(note)).append(';');
        newDisplayContents.append('\n').append(note);
      }
      if (newDisplayContents.length() > 0) {
        newContents.append(';');
        contents=newContents.toString();
        displayContents=newDisplayContents.toString();
        title=activity.getString(R.string.contents_contact);
      }
 else {
        contents=null;
        displayContents=null;
      }
    }
  }
 else   if (type.equals(Contents.Type.LOCATION)) {
    Bundle bundle=intent.getBundleExtra(Intents.Encode.DATA);
    if (bundle != null) {
      float latitude=bundle.getFloat("LAT",Float.MAX_VALUE);
      float longitude=bundle.getFloat("LONG",Float.MAX_VALUE);
      if (latitude != Float.MAX_VALUE && longitude != Float.MAX_VALUE) {
        contents="geo:" + latitude + ','+ longitude;
        displayContents=latitude + "," + longitude;
        title=activity.getString(R.string.contents_location);
      }
    }
  }
}
