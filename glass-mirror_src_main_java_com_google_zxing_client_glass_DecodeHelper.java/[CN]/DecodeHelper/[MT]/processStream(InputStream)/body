{
  BufferedImage image;
  try {
    image=ImageIO.read(is);
  }
 catch (  CMMException|IllegalArgumentException e) {
    throw new IOException(e);
  }
  if (image == null) {
    throw new IOException("No image");
  }
  if (image.getHeight() <= 1 || image.getWidth() <= 1 || image.getHeight() * image.getWidth() > MAX_PIXELS) {
    throw new IOException("Dimensions out of bounds: " + image.getWidth() + 'x'+ image.getHeight());
  }
  return processImage(image);
}
