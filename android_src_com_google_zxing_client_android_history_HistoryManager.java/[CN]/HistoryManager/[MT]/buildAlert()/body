{
  List<String> items=getHistoryItems();
  final String[] dialogItems=new String[items.size() + 1];
  for (int i=0; i < items.size(); i++) {
    dialogItems[i]=items.get(i);
  }
  dialogItems[dialogItems.length - 1]=activity.getResources().getString(R.string.history_clear_text);
  DialogInterface.OnClickListener clickListener=new DialogInterface.OnClickListener(){
    public void onClick(    DialogInterface dialogInterface,    int i){
      if (i == dialogItems.length - 1) {
        clearHistory();
      }
 else {
        Result result=new Result(dialogItems[i],null,null,null);
        Message message=Message.obtain(activity.getHandler(),R.id.decode_succeeded,result);
        message.sendToTarget();
      }
    }
  }
;
  AlertDialog.Builder builder=new AlertDialog.Builder(activity);
  builder.setTitle(R.string.history_title);
  builder.setItems(dialogItems,clickListener);
  return builder.create();
}
