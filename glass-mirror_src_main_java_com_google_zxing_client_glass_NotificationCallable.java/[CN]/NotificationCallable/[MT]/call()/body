{
  MirrorClient mirrorClient=MirrorClient.get();
  TimelineItem timelineItem=mirrorClient.getTimelineItem(credential,timelineItemID);
  if (timelineItem == null) {
    return null;
  }
  List<Attachment> attachments=timelineItem.getAttachments();
  if (attachments == null || attachments.isEmpty()) {
    return null;
  }
  Attachment attachment=attachments.get(0);
  String attachmentId=attachment.getId();
  String errorMessage=null;
  Collection<Result> results=null;
  try (InputStream in=mirrorClient.getAttachmentInputStream(credential,timelineItemID,attachmentId)){
    results=DecodeHelper.processStream(in);
  }
 catch (  IOException|RuntimeException e) {
    errorMessage=e.toString();
  }
  if (results == null || results.isEmpty()) {
    TimelineItem resultTimelineItem=new TimelineItem();
    if (errorMessage == null) {
      resultTimelineItem.setTitle(resources.getString("scan.result.notfound.title"));
      resultTimelineItem.setText(resources.getString("scan.result.notfound.text"));
    }
 else {
      resultTimelineItem.setTitle(resources.getString("scan.result.error.title"));
      resultTimelineItem.setText(MessageFormat.format(resources.getString("scan.result.error.text"),errorMessage));
    }
    mirrorClient.insertTimelineItem(credential,resultTimelineItem);
  }
 else {
    for (    Result result : results) {
      ParsedResult parsedResult=ResultParser.parseResult(result);
      TimelineItem resultTimelineItem=new TimelineItem();
      resultTimelineItem.setText(parsedResult.getDisplayResult());
      resultTimelineItem.setTitle(MessageFormat.format(resources.getString("scan.result.success.title"),parsedResult.getType()));
      addResultDetailToTimelineItem(parsedResult,resultTimelineItem);
      mirrorClient.insertTimelineItem(credential,resultTimelineItem);
    }
  }
  return null;
}
