def GenerateDSW(dswfile, source, env):
    'Generates a Solution/Workspace file based on the version of MSVS that is being used'
    version_num = 6.0
    if ('MSVS_VERSION' in env):
        (version_num, suite) = msvs_parse_version(env['MSVS_VERSION'])
    if (version_num >= 7.0):
        g = _GenerateV7DSW(dswfile, source, env)
        g.Build()
    else:
        g = _GenerateV6DSW(dswfile, source, env)
        g.Build()
