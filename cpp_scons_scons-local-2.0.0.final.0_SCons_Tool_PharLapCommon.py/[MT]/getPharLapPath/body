def getPharLapPath():
    'Reads the registry to find the installed path of the Phar Lap ETS\n    development kit.\n\n    Raises UserError if no installed version of Phar Lap can\n    be found.'
    if (not SCons.Util.can_read_reg):
        raise SCons.Errors.InternalError('No Windows registry module was found')
    try:
        k = SCons.Util.RegOpenKeyEx(SCons.Util.HKEY_LOCAL_MACHINE, 'SOFTWARE\\Pharlap\\ETS')
        (val, type) = SCons.Util.RegQueryValueEx(k, 'BaseDir')
        idx = val.find('\x00')
        if (idx >= 0):
            val = val[:idx]
        return os.path.normpath(val)
    except SCons.Util.RegError:
        raise SCons.Errors.UserError('Cannot find Phar Lap ETS path in the registry.  Is it installed properly?')
