def process_cmd_output(cmd_stdout, cmd_stderr, stdout, stderr):
    stdout_eof = stderr_eof = 0
    while (not (stdout_eof and stderr_eof)):
        try:
            (i, o, e) = select.select([cmd_stdout, cmd_stderr], [], [])
            if (cmd_stdout in i):
                str = cmd_stdout.read()
                if (len(str) == 0):
                    stdout_eof = 1
                elif (stdout is not None):
                    stdout.write(str)
            if (cmd_stderr in i):
                str = cmd_stderr.read()
                if (len(str) == 0):
                    stderr_eof = 1
                else:
                    stderr.write(str)
        except select.error as (_errno, _strerror):
            if (_errno != errno.EINTR):
                raise
