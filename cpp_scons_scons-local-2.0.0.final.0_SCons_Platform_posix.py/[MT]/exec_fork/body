def exec_fork(l, env):
    pid = os.fork()
    if (not pid):
        exitval = 127
        try:
            os.execvpe(l[0], l, env)
        except OSError as e:
            exitval = exitvalmap.get(e[0], e[0])
            sys.stderr.write(('scons: %s: %s\n' % (l[0], e[1])))
        os._exit(exitval)
    else:
        (pid, stat) = os.waitpid(pid, 0)
        if (stat & 255):
            return (stat | 128)
        return (stat >> 8)
