{
  int width=getWidth();
  int height=getHeight();
  int area=width * height;
  byte[] matrix=new byte[area];
  int[] rgb=new int[area];
  image.getRGB(rgb,0,width,0,0,width,height);
  int offset=height * (width - 1);
  for (int y=0; y < height; y++) {
    for (int x=0; x < width; x++) {
      matrix[offset - height * x + y]=toLuminance(rgb[y * width + x]);
    }
  }
  return matrix;
}
