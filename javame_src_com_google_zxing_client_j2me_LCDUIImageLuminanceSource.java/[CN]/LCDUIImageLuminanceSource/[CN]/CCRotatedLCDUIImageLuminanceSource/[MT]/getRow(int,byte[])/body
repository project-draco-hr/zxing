{
  int height=getHeight();
  if (y < 0 || y >= height) {
    throw new IllegalArgumentException("Requested row is outside the image: " + y);
  }
  int width=getWidth();
  if (row == null || row.length < width) {
    row=new byte[width];
  }
  if (rgbData == null || rgbData.length < width) {
    rgbData=new int[width];
  }
  image.getRGB(rgbData,0,height,height - 1 - y,0,1,width);
  for (int x=0; x < width; x++) {
    row[x]=toLuminance(rgbData[x]);
  }
  return row;
}
