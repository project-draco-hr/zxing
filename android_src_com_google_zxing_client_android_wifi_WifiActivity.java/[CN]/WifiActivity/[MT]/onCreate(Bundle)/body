{
  super.onCreate(savedInstanceState);
  Intent intent=getIntent();
  if (intent == null || (!intent.getAction().equals(Intents.WifiConnect.ACTION))) {
    finish();
    return;
  }
  String ssid=intent.getStringExtra(Intents.WifiConnect.SSID);
  String password=intent.getStringExtra(Intents.WifiConnect.PASSWORD);
  String networkType=intent.getStringExtra(Intents.WifiConnect.TYPE);
  setContentView(R.layout.network);
  statusView=(TextView)findViewById(R.id.networkStatus);
  NetworkType networkT;
  if (networkType.equals("WPA")) {
    networkT=NetworkType.NETWORK_WPA;
  }
 else   if (networkType.equals("WEP")) {
    networkT=NetworkType.NETWORK_WEP;
  }
 else   if (networkType.equals("nopass")) {
    networkT=NetworkType.NETWORK_NOPASS;
  }
 else {
    doError(R.string.wifi_type_incorrect);
    return;
  }
  wifiManager=(WifiManager)this.getSystemService(WIFI_SERVICE);
  wifiManager.setWifiEnabled(true);
  wifiReceiver=new WifiReceiver(wifiManager,this,statusView,ssid);
  mWifiStateFilter=new IntentFilter(WifiManager.WIFI_STATE_CHANGED_ACTION);
  mWifiStateFilter.addAction(ConnectivityManager.CONNECTIVITY_ACTION);
  mWifiStateFilter.addAction(WifiManager.SUPPLICANT_STATE_CHANGED_ACTION);
  mWifiStateFilter.addAction(WifiManager.NETWORK_STATE_CHANGED_ACTION);
  registerReceiver(wifiReceiver,mWifiStateFilter);
  receiverRegistered=true;
  if (password == null) {
    password="";
  }
  Log.d(TAG,"Adding new configuration: \nSSID: " + ssid + "Type: "+ networkT);
  NetworkSetting setting=new NetworkSetting(ssid,password,networkT);
  changeNetwork(setting);
}
