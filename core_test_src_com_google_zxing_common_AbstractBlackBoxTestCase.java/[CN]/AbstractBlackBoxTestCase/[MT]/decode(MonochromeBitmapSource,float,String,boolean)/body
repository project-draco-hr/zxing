{
  Result result;
  String suffix=" (" + (tryHarder ? "try harder, " : "") + "rotation: "+ rotation+ ')';
  try {
    result=barcodeReader.decode(source,tryHarder ? TRY_HARDER_HINT : null);
  }
 catch (  ReaderException re) {
    System.out.println(re + suffix);
    return false;
  }
  if (!expectedFormat.equals(result.getBarcodeFormat())) {
    System.out.println("Format mismatch: expected '" + expectedFormat + "' but got '"+ result.getBarcodeFormat()+ "'"+ suffix);
    return false;
  }
  String resultText=result.getText();
  if (!expectedText.equals(resultText)) {
    System.out.println("Mismatch: expected '" + expectedText + "' but got '"+ resultText+ "'"+ suffix);
    return false;
  }
  return true;
}
