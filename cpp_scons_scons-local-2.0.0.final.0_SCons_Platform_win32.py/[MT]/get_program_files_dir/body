def get_program_files_dir():
    val = ''
    if SCons.Util.can_read_reg:
        try:
            k = SCons.Util.RegOpenKeyEx(SCons.Util.hkey_mod.HKEY_LOCAL_MACHINE, 'Software\\Microsoft\\Windows\\CurrentVersion')
            (val, tok) = SCons.Util.RegQueryValueEx(k, 'ProgramFilesDir')
        except SCons.Util.RegError:
            val = ''
            pass
    if (val == ''):
        val = os.path.join(os.path.dirname(get_system_root()), 'Program Files')
    return val
