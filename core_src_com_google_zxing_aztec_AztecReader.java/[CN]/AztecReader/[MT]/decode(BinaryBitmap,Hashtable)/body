{
  AztecDetectorResult detectorResult=new Detector(image.getBlackMatrix()).detect();
  ResultPoint[] points=detectorResult.getPoints();
  if (hints != null) {
    ResultPointCallback rpcb=(ResultPointCallback)hints.get(DecodeHintType.NEED_RESULT_POINT_CALLBACK);
    if (rpcb != null) {
      for (int i=0; i < points.length; i++) {
        rpcb.foundPossibleResultPoint(points[i]);
      }
    }
  }
  DecoderResult decoderResult=new Decoder().decode(detectorResult);
  Result result=new Result(decoderResult.getText(),decoderResult.getRawBytes(),points,BarcodeFormat.AZTEC);
  Vector byteSegments=decoderResult.getByteSegments();
  if (byteSegments != null) {
    result.putMetadata(ResultMetadataType.BYTE_SEGMENTS,byteSegments);
  }
  String ecLevel=decoderResult.getECLevel();
  if (ecLevel != null) {
    result.putMetadata(ResultMetadataType.ERROR_CORRECTION_LEVEL,ecLevel);
  }
  return result;
}
