{
  DecoderResult decoderResult;
  ResultPoint[] points;
  AztecDetectorResult detectorResult=new Detector(image.getBlackMatrix()).detect();
  points=detectorResult.getPoints();
  if (hints != null && detectorResult.getPoints() != null) {
    ResultPointCallback rpcb=(ResultPointCallback)hints.get(DecodeHintType.NEED_RESULT_POINT_CALLBACK);
    if (rpcb != null) {
      for (int i=0; i < detectorResult.getPoints().length; i++) {
        rpcb.foundPossibleResultPoint(detectorResult.getPoints()[i]);
      }
    }
  }
  decoderResult=new Decoder().decode(detectorResult);
  Result result=new Result(decoderResult.getText(),decoderResult.getRawBytes(),points,BarcodeFormat.AZTEC);
  if (decoderResult.getByteSegments() != null) {
    result.putMetadata(ResultMetadataType.BYTE_SEGMENTS,decoderResult.getByteSegments());
  }
  if (decoderResult.getECLevel() != null) {
    result.putMetadata(ResultMetadataType.ERROR_CORRECTION_LEVEL,decoderResult.getECLevel().toString());
  }
  return result;
}
