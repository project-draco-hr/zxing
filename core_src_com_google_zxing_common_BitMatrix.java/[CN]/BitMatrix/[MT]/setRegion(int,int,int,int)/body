{
  if (topI < 0 || leftJ < 0) {
    throw new IllegalArgumentException("topI and leftJ must be nonnegative");
  }
  if (height < 1 || width < 1) {
    throw new IllegalArgumentException("height and width must be at least 1");
  }
  int maxJ=leftJ + width;
  int maxI=topI + height;
  if (maxI > dimension || maxJ > dimension) {
    throw new IllegalArgumentException("topI + height and leftJ + width must be <= matrix dimension");
  }
  for (int j=leftJ; j < maxJ; j++) {
    int jOffset=dimension * j;
    for (int i=topI; i < maxI; i++) {
      int offset=i + jOffset;
      bits[offset >> 5]|=1 << (offset & 0x1F);
    }
  }
}
