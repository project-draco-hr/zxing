{
  GF256Poly poly=new GF256Poly(field,received);
  int[] syndromeCoefficients=new int[twoS];
  boolean dataMatrix=field.equals(GF256.DATA_MATRIX_FIELD);
  boolean noError=true;
  for (int i=0; i < twoS; i++) {
    int eval=poly.evaluateAt(field.exp(dataMatrix ? i + 1 : i));
    syndromeCoefficients[syndromeCoefficients.length - 1 - i]=eval;
    if (eval != 0) {
      noError=false;
    }
  }
  if (noError) {
    return;
  }
  GF256Poly syndrome=new GF256Poly(field,syndromeCoefficients);
  GF256Poly[] sigmaOmega=runEuclideanAlgorithm(field.buildMonomial(twoS,1),syndrome,twoS);
  GF256Poly sigma=sigmaOmega[0];
  GF256Poly omega=sigmaOmega[1];
  int[] errorLocations=findErrorLocations(sigma);
  int[] errorMagnitudes=findErrorMagnitudes(omega,errorLocations,dataMatrix);
  for (int i=0; i < errorLocations.length; i++) {
    int position=received.length - 1 - field.log(errorLocations[i]);
    if (position < 0) {
      throw new ReedSolomonException("Bad error location");
    }
    received[position]=GF256.addOrSubtract(received[position],errorMagnitudes[i]);
  }
}
