def convert_to_id(s, id_set):
    ' Some parts of .wxs need an Id attribute (for example: The File and\n    Directory directives. The charset is limited to A-Z, a-z, digits,\n    underscores, periods. Each Id must begin with a letter or with a\n    underscore. Google for "CNDL0015" for information about this.\n\n    Requirements:\n     * the string created must only contain chars from the target charset.\n     * the string created must have a minimal editing distance from the\n       original string.\n     * the string created must be unique for the whole .wxs file.\n\n    Observation:\n     * There are 62 chars in the charset.\n\n    Idea:\n     * filter out forbidden characters. Check for a collision with the help\n       of the id_set. Add the number of the number of the collision at the\n       end of the created string. Furthermore care for a correct start of\n       the string.\n    '
    charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYabcdefghijklmnopqrstuvwxyz0123456789_.'
    if (s[0] in '0123456789.'):
        s += ('_' + s)
    id = [c for c in s if (c in charset)]
    try:
        return id_set[id][s]
    except KeyError:
        if (id not in id_set):
            id_set[id] = {s: id, }
        else:
            id_set[id][s] = (id + str(len(id_set[id])))
        return id_set[id][s]
