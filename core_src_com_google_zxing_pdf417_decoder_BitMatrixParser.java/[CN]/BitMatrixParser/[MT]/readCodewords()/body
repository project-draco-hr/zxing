{
  int height=bitMatrix.getHeight();
  erasures=new int[MAX_CW_CAPACITY];
  int[] codewords=new int[MAX_CW_CAPACITY];
  int next=0;
  int rowNumber=0;
  for (int i=0; i < height; i++) {
    if (rowNumber >= MAX_ROWS) {
      throw FormatException.getFormatInstance();
    }
    next=processRow(rowNumber,codewords,next);
    rowNumber++;
  }
  erasures=trimArray(erasures,eraseCount);
  return trimArray(codewords,next);
}
