{
  if (contents == null || contents.length() == 0) {
    throw new IllegalArgumentException("Found empty contents");
  }
  if (format != BarcodeFormat.QR_CODE) {
    throw new IllegalArgumentException("Can only encode QR_CODE, but got " + format);
  }
  if (width < 0 || height < 0) {
    throw new IllegalArgumentException("Requested dimensions are too small: " + width + "x"+ height);
  }
  int errorCorrectionLevel=QRCode.EC_LEVEL_L;
  if (hints != null) {
    Integer requestedECLevel=(Integer)hints.get(EncodeHintType.ERROR_CORRECTION);
    if (requestedECLevel != null) {
      errorCorrectionLevel=requestedECLevel.intValue();
    }
  }
  QRCode code=new QRCode();
  Encoder.encode(new ByteArray(contents),errorCorrectionLevel,code);
  return renderResult(code,width,height);
}
