{
  lastResult=rawResult;
  historyManager.addHistoryItem(rawResult);
  if (barcode == null) {
    handleDecodeInternally(rawResult,null);
  }
 else {
    playBeepSoundAndVibrate();
    drawResultPoints(barcode,rawResult);
switch (source) {
case NATIVE_APP_INTENT:
case PRODUCT_SEARCH_LINK:
      handleDecodeExternally(rawResult,barcode);
    break;
case ZXING_LINK:
  if (returnUrlTemplate == null) {
    handleDecodeInternally(rawResult,barcode);
  }
 else {
    handleDecodeExternally(rawResult,barcode);
  }
break;
case NONE:
SharedPreferences prefs=PreferenceManager.getDefaultSharedPreferences(this);
if (prefs.getBoolean(PreferencesActivity.KEY_BULK_MODE,false)) {
Toast.makeText(this,R.string.msg_bulk_mode_scanned,Toast.LENGTH_SHORT).show();
try {
Thread.sleep(BULK_MODE_SCAN_DELAY_MS);
}
 catch (InterruptedException ie) {
}
resetStatusView();
if (handler != null) {
handler.sendEmptyMessage(R.id.restart_preview);
}
}
 else {
handleDecodeInternally(rawResult,barcode);
}
break;
}
}
}
