{
  super.onResume();
  WindowManager manager=(WindowManager)getSystemService(WINDOW_SERVICE);
  Display display=manager.getDefaultDisplay();
  int width=display.getWidth();
  int height=display.getHeight();
  int smallerDimension=width < height ? width : height;
  smallerDimension=smallerDimension * 7 / 8;
  Intent intent=getIntent();
  try {
    qrCodeEncoder=new QRCodeEncoder(this,intent,smallerDimension);
    setTitle(getString(R.string.app_name) + " - " + qrCodeEncoder.getTitle());
    Bitmap bitmap=qrCodeEncoder.encodeAsBitmap();
    ImageView view=(ImageView)findViewById(R.id.image_view);
    view.setImageBitmap(bitmap);
    TextView contents=(TextView)findViewById(R.id.contents_text_view);
    contents.setText(qrCodeEncoder.getDisplayContents());
  }
 catch (  WriterException e) {
    Log.e(TAG,"Could not encode barcode",e);
    showErrorMessage(R.string.msg_encode_contents_failed);
    qrCodeEncoder=null;
  }
catch (  IllegalArgumentException e) {
    Log.e(TAG,"Could not encode barcode",e);
    showErrorMessage(R.string.msg_encode_contents_failed);
    qrCodeEncoder=null;
  }
}
