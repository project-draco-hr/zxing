{
  BufferedImage image;
  try {
    image=ImageIO.read(file);
  }
 catch (  IOException ioe) {
    return ioe.toString();
  }
  if (image == null) {
    return "Could not decode image";
  }
  LuminanceSource source=new BufferedImageLuminanceSource(image);
  BinaryBitmap bitmap=new BinaryBitmap(new GlobalHistogramBinarizer(source));
  Result result;
  try {
    result=new MultiFormatReader().decode(bitmap);
  }
 catch (  ReaderException re) {
    return re.toString();
  }
  return result.getText();
}
