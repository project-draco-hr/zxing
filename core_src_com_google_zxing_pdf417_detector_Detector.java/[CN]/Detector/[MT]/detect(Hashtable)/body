{
  BitMatrix matrix=image.getBlackMatrix();
  ResultPoint[] vertices=findVertices(matrix);
  if (vertices == null) {
    vertices=findVertices180(matrix);
    if (vertices != null) {
      correctCodeWordVertices(vertices,true);
    }
  }
 else {
    correctCodeWordVertices(vertices,false);
  }
  if (vertices != null) {
    float moduleWidth=computeModuleWidth(vertices);
    if (moduleWidth < 1.0f) {
      throw ReaderException.getInstance();
    }
    int dimension=computeDimension(vertices[4],vertices[6],vertices[5],vertices[7],moduleWidth);
    if (dimension < 1) {
      throw ReaderException.getInstance();
    }
    BitMatrix bits=sampleGrid(matrix,vertices[4],vertices[5],vertices[6],vertices[7],dimension);
    return new DetectorResult(bits,new ResultPoint[]{vertices[4],vertices[5],vertices[6],vertices[7]});
  }
 else {
    throw ReaderException.getInstance();
  }
}
