{
  BitMatrix matrix=image.getBlackMatrix();
  boolean tryHarder=hints != null && hints.containsKey(DecodeHintType.TRY_HARDER);
  ResultPoint[] vertices=findVertices(matrix,tryHarder);
  if (vertices == null) {
    vertices=findVertices180(matrix,tryHarder);
    if (vertices != null) {
      correctCodeWordVertices(vertices,true);
    }
  }
 else {
    correctCodeWordVertices(vertices,false);
  }
  if (vertices == null) {
    throw NotFoundException.getNotFoundInstance();
  }
  float moduleWidth=computeModuleWidth(vertices);
  if (moduleWidth < 1.0f) {
    throw NotFoundException.getNotFoundInstance();
  }
  int dimension=computeDimension(vertices[4],vertices[6],vertices[5],vertices[7],moduleWidth);
  if (dimension < 1) {
    throw NotFoundException.getNotFoundInstance();
  }
  int ydimension=computeYDimension(vertices[4],vertices[6],vertices[5],vertices[7],moduleWidth);
  ydimension=ydimension > dimension ? ydimension : dimension;
  BitMatrix bits=sampleGrid(matrix,vertices[4],vertices[5],vertices[6],vertices[7],dimension,ydimension);
  return new DetectorResult(bits,new ResultPoint[]{vertices[5],vertices[4],vertices[6],vertices[7]});
}
