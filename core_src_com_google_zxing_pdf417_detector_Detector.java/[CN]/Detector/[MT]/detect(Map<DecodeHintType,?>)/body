{
  BitMatrix matrix=image.getBlackMatrix();
  ResultPoint[] vertices=findVertices(matrix);
  if (vertices == null) {
    vertices=findVertices180(matrix);
    if (vertices != null) {
      correctCodeWordVertices(vertices,true);
    }
  }
 else {
    correctCodeWordVertices(vertices,false);
  }
  if (vertices == null) {
    throw NotFoundException.getNotFoundInstance();
  }
  float moduleWidth=computeModuleWidth(vertices);
  if (moduleWidth < 1.0f) {
    throw NotFoundException.getNotFoundInstance();
  }
  int dimension=computeDimension(vertices[4],vertices[6],vertices[5],vertices[7],moduleWidth);
  if (dimension < 1) {
    throw NotFoundException.getNotFoundInstance();
  }
  BitMatrix bits=sampleGrid(matrix,vertices[4],vertices[5],vertices[6],vertices[7],dimension);
  return new DetectorResult(bits,new ResultPoint[]{vertices[5],vertices[4],vertices[6],vertices[7]});
}
