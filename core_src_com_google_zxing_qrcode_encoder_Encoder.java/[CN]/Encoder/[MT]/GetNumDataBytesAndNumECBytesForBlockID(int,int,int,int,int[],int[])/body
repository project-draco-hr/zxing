{
  if (block_id >= num_rs_blocks) {
    throw new WriterException("Block ID too large");
  }
  final int num_rs_blocks_in_group2=num_total_bytes % num_rs_blocks;
  final int num_rs_blocks_in_group1=num_rs_blocks - num_rs_blocks_in_group2;
  final int num_total_bytes_in_group1=num_total_bytes / num_rs_blocks;
  final int num_total_bytes_in_group2=num_total_bytes_in_group1 + 1;
  final int num_data_bytes_in_group1=num_data_bytes / num_rs_blocks;
  final int num_data_bytes_in_group2=num_data_bytes_in_group1 + 1;
  final int num_ec_bytes_in_group1=num_total_bytes_in_group1 - num_data_bytes_in_group1;
  final int num_ec_bytes_in_group2=num_total_bytes_in_group2 - num_data_bytes_in_group2;
  if (num_ec_bytes_in_group1 != num_ec_bytes_in_group2) {
    throw new WriterException("EC bytes mismatch");
  }
  if (num_rs_blocks != num_rs_blocks_in_group1 + num_rs_blocks_in_group2) {
    throw new WriterException("RS blocks mismatch");
  }
  if (num_total_bytes != ((num_data_bytes_in_group1 + num_ec_bytes_in_group1) * num_rs_blocks_in_group1) + ((num_data_bytes_in_group2 + num_ec_bytes_in_group2) * num_rs_blocks_in_group2)) {
    throw new WriterException("Total bytes mismatch");
  }
  if (block_id < num_rs_blocks_in_group1) {
    num_data_bytes_in_block[0]=num_data_bytes_in_group1;
    num_ec_bytes_in_block[0]=num_ec_bytes_in_group1;
  }
 else {
    num_data_bytes_in_block[0]=num_data_bytes_in_group2;
    num_ec_bytes_in_block[0]=num_ec_bytes_in_group2;
  }
}
