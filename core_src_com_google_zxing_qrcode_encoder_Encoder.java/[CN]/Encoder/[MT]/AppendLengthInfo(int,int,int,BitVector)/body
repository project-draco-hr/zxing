{
  int num_letters=num_bytes;
  if (mode == QRCode.MODE_KANJI) {
    if (num_letters % 2 != 0) {
      throw new WriterException("Number of letters must be even");
    }
    num_letters/=2;
  }
  final int num_bits=QRCode.GetNumBitsForLength(version,mode);
  if (num_letters > ((1 << num_bits) - 1)) {
    throw new WriterException(num_letters + "is bigger than" + ((1 << num_bits) - 1));
  }
  bits.AppendBits(num_letters,num_bits);
}
