{
  String remoteIPAddressString=request.getRemoteAddr();
  if (bannedIPAddresses.contains(remoteIPAddressString) || badIPAddresses.contains(remoteIPAddressString)) {
    return true;
  }
  InetAddress remoteIPAddress;
  try {
    remoteIPAddress=InetAddress.getByName(remoteIPAddressString);
  }
 catch (  UnknownHostException uhe) {
    context.log("Can't determine host from: " + remoteIPAddressString + "; assuming banned");
    return true;
  }
  if (numRecentAccesses.incrementAndGet(remoteIPAddress) > MAX_ACCESSES_PER_IP_PER_TIME) {
    context.log("Possible DoS attack from " + remoteIPAddressString);
    bannedIPAddresses.add(remoteIPAddressString);
    return true;
  }
  return false;
}
