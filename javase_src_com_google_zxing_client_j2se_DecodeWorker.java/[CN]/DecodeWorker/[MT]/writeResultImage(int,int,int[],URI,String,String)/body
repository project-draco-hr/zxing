{
  BufferedImage result=new BufferedImage(stride,height,BufferedImage.TYPE_INT_ARGB);
  result.setRGB(0,0,stride,height,pixels,0,stride);
  String resultName=inputName;
  if ("http".equals(uri.getScheme())) {
    int pos=resultName.lastIndexOf('/');
    if (pos > 0) {
      resultName='.' + resultName.substring(pos);
    }
  }
  int pos=resultName.lastIndexOf('.');
  if (pos > 0) {
    resultName=resultName.substring(0,pos);
  }
  resultName+=suffix;
  OutputStream outStream=null;
  try {
    outStream=new FileOutputStream(resultName);
    if (!ImageIO.write(result,"png",outStream)) {
      System.err.println("Could not encode an image to " + resultName);
    }
  }
 catch (  FileNotFoundException e) {
    System.err.println("Could not create " + resultName);
  }
catch (  IOException e) {
    System.err.println("Could not write to " + resultName);
  }
 finally {
    try {
      if (outStream != null) {
        outStream.close();
      }
    }
 catch (    IOException ioe) {
    }
  }
}
